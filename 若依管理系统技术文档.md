# 若依管理系统技术文档

## 项目概述

若依管理系统（RuoYi）是一套基于SpringBoot+Vue前后端分离的Java快速开发框架，版本号为v3.9.0。该系统提供了完整的权限管理、用户管理、系统监控等功能，适用于企业级应用的快速开发。

### 基本信息
- **项目名称**: RuoYi管理系统
- **版本**: 3.9.0
- **开发语言**: Java 1.8
- **架构模式**: 前后端分离
- **开源协议**: MIT License

## 技术栈

### 后端技术栈
- **核心框架**: Spring Boot 2.5.15
- **安全框架**: Spring Security 5.7.12
- **持久层框架**: MyBatis
- **数据库连接池**: Druid 1.2.23
- **缓存**: Redis
- **分页插件**: PageHelper 1.4.7
- **权限认证**: JWT (JSON Web Token) 0.9.1
- **验证码**: Kaptcha 2.3.3
- **定时任务**: Quartz
- **API文档**: Swagger 3.0.0
- **JSON处理**: FastJSON 2.0.57
- **Excel处理**: Apache POI 4.1.2
- **模板引擎**: Velocity 2.3
- **系统监控**: OSHI 6.8.1

### 前端技术栈
- **框架**: Vue.js
- **UI组件库**: Element UI
- **构建工具**: Webpack
- **HTTP客户端**: Axios
-启动后端java -jar ruoyi-admin/target/ruoyi-admin.jar
-cd ruoyi-ui && npm run dev
### 数据库
- **主数据库**: MySQL
- **缓存数据库**: Redis

## 系统架构

### 模块结构

```
ruoyi/
├── ruoyi-admin/          # 管理后台模块（启动模块）
├── ruoyi-framework/      # 核心框架模块
├── ruoyi-system/         # 系统业务模块
├── ruoyi-common/         # 通用工具模块
├── ruoyi-generator/      # 代码生成模块
├── ruoyi-quartz/         # 定时任务模块
├── ruoyi-ui/            # 前端Vue项目
├── sql/                 # 数据库脚本
├── doc/                 # 项目文档
└── bin/                 # 启动脚本
```

### 各模块详细说明

#### 1. ruoyi-admin（管理后台模块）
- **作用**: 系统启动入口，包含主启动类和Web控制器
- **主要内容**:
  - `RuoYiApplication.java`: Spring Boot启动类
  - `controller/`: 各业务模块的REST API控制器
    - `system/`: 系统管理相关控制器
    - `monitor/`: 系统监控相关控制器
    - `tool/`: 系统工具相关控制器
    - `common/`: 通用功能控制器
  - `resources/`: 配置文件和静态资源

#### 2. ruoyi-framework（核心框架模块）
- **作用**: 提供系统核心功能和基础设施
- **主要内容**:
  - `config/`: 系统配置类
  - `security/`: Spring Security安全配置
  - `web/`: Web相关配置和异常处理
  - `datasource/`: 数据源配置
  - `interceptor/`: 拦截器
  - `aspectj/`: AOP切面
  - `manager/`: 异步任务管理

#### 3. ruoyi-system（系统业务模块）
- **作用**: 系统核心业务逻辑实现
- **主要内容**:
  - `domain/`: 实体类（用户、角色、菜单、部门等）
  - `mapper/`: MyBatis数据访问层
  - `service/`: 业务逻辑层

#### 4. ruoyi-common（通用工具模块）
- **作用**: 提供系统通用工具类和常量定义
- **主要内容**:
  - `utils/`: 工具类集合
  - `constant/`: 系统常量定义
  - `enums/`: 枚举类
  - `exception/`: 自定义异常
  - `annotation/`: 自定义注解
  - `core/`: 核心基础类
  - `config/`: 通用配置
  - `filter/`: 过滤器
  - `xss/`: XSS防护

#### 5. ruoyi-generator（代码生成模块）
- **作用**: 根据数据库表结构自动生成CRUD代码
- **功能**: 生成Controller、Service、Mapper、实体类等

#### 6. ruoyi-quartz（定时任务模块）
- **作用**: 提供定时任务调度功能
- **功能**: 任务的增删改查、启停控制、执行日志等

## 核心功能

### 1. 用户权限管理
- **用户管理**: 系统用户的增删改查、状态管理
- **角色管理**: 角色权限分配、数据权限控制
- **菜单管理**: 系统菜单配置、按钮权限控制
- **部门管理**: 组织架构管理，支持树形结构
- **岗位管理**: 用户岗位配置

### 2. 系统监控
- **在线用户**: 当前在线用户监控和管理
- **操作日志**: 系统操作记录和查询
- **登录日志**: 用户登录记录和异常监控
- **服务监控**: CPU、内存、磁盘等系统资源监控
- **缓存监控**: Redis缓存状态监控
- **连接池监控**: 数据库连接池状态监控

### 3. 系统工具
- **代码生成**: 基于数据库表自动生成前后端代码
- **系统接口**: Swagger API文档自动生成
- **定时任务**: 在线管理定时任务
- **表单构建**: 可视化表单设计器

### 4. 系统设置
- **参数管理**: 系统动态参数配置
- **字典管理**: 数据字典维护
- **通知公告**: 系统公告发布和管理

## 安全特性

### 1. 认证授权
- **JWT Token**: 无状态的用户认证
- **Spring Security**: 完整的安全框架集成
- **多终端支持**: 支持多设备同时登录

### 2. 数据安全
- **数据权限**: 基于部门的数据访问控制
- **XSS防护**: 跨站脚本攻击防护
- **SQL注入防护**: MyBatis预编译防护
- **CSRF防护**: 跨站请求伪造防护

### 3. 密码安全
- **密码加密**: BCrypt加密存储
- **登录限制**: 密码错误次数限制和账户锁定
- **验证码**: 登录验证码防暴力破解

## 配置说明

### 主要配置文件
- `application.yml`: 主配置文件
- `application-druid.yml`: 数据源配置
- `mybatis-config.xml`: MyBatis配置
- `logback.xml`: 日志配置

### 关键配置项

#### 服务器配置
```yaml
server:
  port: 8080                    # 服务端口
  servlet:
    context-path: /             # 应用访问路径
  tomcat:
    uri-encoding: UTF-8         # URI编码
    accept-count: 1000          # 连接队列长度
    threads:
      max: 800                  # 最大线程数
      min-spare: 100            # 最小线程数
```

#### 数据库配置
```yaml
spring:
  redis:
    host: localhost             # Redis地址
    port: 6379                  # Redis端口
    database: 0                 # Redis数据库
    password:                   # Redis密码
```

#### JWT配置
```yaml
token:
  header: Authorization         # Token请求头
  secret: abcdefghijklmnopqrstuvwxyz  # Token密钥
  expireTime: 30               # Token过期时间（分钟）
```

## 数据库设计

### 核心表结构
- `sys_user`: 用户信息表
- `sys_role`: 角色信息表
- `sys_menu`: 菜单权限表
- `sys_dept`: 部门信息表
- `sys_post`: 岗位信息表
- `sys_user_role`: 用户角色关联表
- `sys_role_menu`: 角色菜单关联表
- `sys_role_dept`: 角色部门关联表
- `sys_dict_type`: 字典类型表
- `sys_dict_data`: 字典数据表
- `sys_config`: 参数配置表
- `sys_notice`: 通知公告表
- `sys_oper_log`: 操作日志表
- `sys_logininfor`: 登录日志表
- `sys_job`: 定时任务表
- `sys_job_log`: 定时任务日志表

## 部署指南

### 环境要求
- **JDK**: 1.8+
- **MySQL**: 5.7+
- **Redis**: 3.0+
- **Maven**: 3.6+
- **Node.js**: 12+ (前端构建)

### 部署步骤

#### 1. 数据库初始化
```sql
-- 创建数据库
CREATE DATABASE ry CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;

-- 导入数据库脚本
source sql/ry_20250522.sql;
source sql/quartz.sql;
```

#### 2. 后端部署
```bash
# 克隆项目
git clone https://gitee.com/y_project/RuoYi-Vue.git

# 进入项目目录
cd RuoYi-Vue

# 修改数据库配置
vim ruoyi-admin/src/main/resources/application-druid.yml

# 编译打包
mvn clean package -Dmaven.test.skip=true

# 运行项目
java -jar ruoyi-admin/target/ruoyi-admin.jar
```

#### 3. 前端部署
```bash
# 进入前端目录
cd ruoyi-ui

# 安装依赖
npm install

# 开发环境运行
npm run dev

# 生产环境构建
npm run build:prod
```

### Docker部署
```dockerfile
# Dockerfile示例
FROM openjdk:8-jre-alpine
VOLUME /tmp
COPY ruoyi-admin.jar app.jar
EXPOSE 8080
ENTRYPOINT ["java","-jar","/app.jar"]
```

## 开发指南

### 代码生成使用
1. 登录系统后台
2. 进入"系统工具" -> "代码生成"
3. 选择要生成代码的数据表
4. 配置生成信息（包名、作者、表前缀等）
5. 点击生成代码，下载生成的代码包
6. 将代码导入到对应模块中

### 新增业务模块
1. 在`ruoyi-system`模块中创建对应的domain、mapper、service
2. 在`ruoyi-admin`模块中创建controller
3. 配置MyBatis映射文件
4. 添加菜单权限配置

### 自定义权限注解
```java
@PreAuthorize("@ss.hasPermi('system:user:list')")
@GetMapping("/list")
public TableDataInfo list(SysUser user) {
    // 业务逻辑
}
```

## 性能优化

### 1. 数据库优化
- 合理使用索引
- 分页查询优化
- 连接池配置调优

### 2. 缓存优化
- Redis缓存热点数据
- 菜单权限缓存
- 字典数据缓存

### 3. 代码优化
- 异步任务处理
- 批量操作优化
- 避免N+1查询问题

## 常见问题

### 1. 启动问题
- **问题**: 启动时数据库连接失败
- **解决**: 检查数据库配置和网络连接

### 2. 权限问题
- **问题**: 登录后无法访问菜单
- **解决**: 检查用户角色和菜单权限配置

### 3. 跨域问题
- **问题**: 前端请求后端接口跨域
- **解决**: 配置CORS或使用代理

## 扩展开发

### 1. 集成第三方登录
- 支持微信、QQ、支付宝等第三方登录
- OAuth2.0协议集成

### 2. 消息推送
- WebSocket实时消息推送
- 邮件/短信通知集成

### 3. 文件存储
- 本地文件存储
- 阿里云OSS/腾讯云COS集成
- MinIO对象存储集成

## 版本更新

### v3.9.0 更新内容
- 升级Spring Boot版本
- 优化安全配置
- 修复已知问题
- 性能优化

## 技术支持

### 官方资源
- **官方网站**: http://www.ruoyi.vip
- **在线演示**: http://vue.ruoyi.vip
- **开发文档**: http://doc.ruoyi.vip
- **源码地址**: https://gitee.com/y_project/RuoYi-Vue

### 社区支持
- **QQ交流群**: 多个技术交流群
- **GitHub Issues**: 问题反馈和建议
- **技术论坛**: 开发者交流平台

## 许可证

本项目基于MIT许可证开源，允许个人和企业免费使用。

---

**文档版本**: v1.0  
**更新时间**: 2025年1月  
**维护者**: 若依开发团队 